# This file is generated from setup_tools_yaml.py using environment variables from .env
# DO NOT EDIT MANUALLY - Generate using: python setup_tools_yaml.py
#
# This template shows what the generated file will look like.
# Replace $NEO4J_URI, $NEO4J_USERNAME, $NEO4J_PASSWORD, $NEO4J_DATABASE with actual values

sources:
  companies-graph:
    kind: "neo4j"
    uri: "$NEO4J_URI"           # e.g., neo4j+s://demo.neo4jlabs.com
    user: "$NEO4J_USERNAME"     # e.g., companies
    password: "$NEO4J_PASSWORD" # e.g., companies
    database: "$NEO4J_DATABASE" # e.g., companies

tools:
  companies_in_industry:
    kind: neo4j-cypher
    source: companies-graph
    statement: |
      MATCH (:IndustryCategory {name:$industry})<-[:HAS_CATEGORY]-(c) 
      WHERE NOT EXISTS { (c)<-[:HAS_SUBSIDARY]-() }
      RETURN c.id as company_id, c.name as name, c.summary as summary
    description: Companies (company_id, name, summary) in a given industry by industry
    parameters:
      - name: industry
        type: string
        description: Industry name to filter companies by

  companies:
    kind: neo4j-cypher
    source: companies-graph
    statement: |
      CALL db.index.fulltext.queryNodes("companies_fulltext", $search)
      YIELD node AS c, score
      RETURN c.id as company_id, c.name as name, c.summary as summary
      LIMIT 10
    description: List of Companies (id, name, summary) matching search text
    parameters:
      - name: search
        type: string
        description: Full-text search query for company names

  industries:
    kind: neo4j-cypher
    source: companies-graph
    statement: |
      MATCH (i:IndustryCategory)
      RETURN DISTINCT i.name as industry_name
      ORDER BY i.name
    description: List of Industry names
    parameters: []

  articles_in_month:
    kind: neo4j-cypher
    source: companies-graph
    statement: |
      MATCH (a:Article)
      WHERE date($date) <= date(a.date) < date($date) + duration('P1M')
      RETURN a.id as article_id, a.author as author, a.title as title, toString(a.date) as date, a.sentiment as sentiment
      LIMIT 25
    description: List of Articles (id, author, title, date, sentiment) in a month timeframe from the given date
    parameters:
      - name: date
        type: string
        description: Start date in yyyy-mm-dd format

  article:
    kind: neo4j-cypher
    source: companies-graph
    statement: |
      MATCH (a:Article {id: $article_id})
      RETURN a.id as article_id, a.author as author, a.title as title, 
             toString(a.date) as date, a.sentiment as sentiment, 
             a.site as site, a.summary as summary, a.content as content
    description: Single Article details by article ID
    parameters:
      - name: article_id
        type: string
        description: Article ID to fetch

  companies_in_articles:
    kind: neo4j-cypher
    source: companies-graph
    statement: |
      MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
      WHERE a.id IN $article_ids
      RETURN DISTINCT o.id as company_id, o.name as name, o.summary as summary
    description: Companies mentioned in articles by article IDs
    parameters:
      - name: article_ids
        type: array
        description: List of article IDs

  people_at_company:
    kind: neo4j-cypher
    source: companies-graph
    statement: |
      MATCH (p:Person)-[r]-(o:Organization {id: $company_id})
      WHERE type(r) IN ["HAS_CEO", "HAS_BOARD_MEMBER"]
      RETURN p.name as name, type(r) as role
    description: People (name, role) associated with a company by company ID
    parameters:
      - name: company_id
        type: string
        description: Company ID to find people for
